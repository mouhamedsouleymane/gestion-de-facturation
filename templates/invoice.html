{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block content %}

<div class="row justify-content-center">
  <div class="col-lg-10">
    <!-- Invoice Header -->
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-body p-4">
        <div class="row align-items-center mb-4">
          <div class="col-md-6">
            <h1 class="h3 fw-bold mb-1">
              <i class="fas fa-file-invoice me-2 text-primary"></i>
              Invoice #{{ obj.id }}
            </h1>
            <p class="text-muted mb-0">{{ obj.invoice_date_time|date:"d F Y" }}</p>
          </div>
          <div class="col-md-6 text-md-end">
            <span class="badge bg-primary me-2">{{ obj.get_invoice_type_display }}</span>
            {% if obj.paid %}
            <span class="badge bg-success">
              <i class="fas fa-check-circle me-1"></i>Paid
            </span>
            {% else %}
            <span class="badge bg-warning">
              <i class="fas fa-hourglass-half me-1"></i>Pending
            </span>
            {% endif %}
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="d-flex gap-2 flex-wrap">
          <a href="{% url 'invoice-pdf' pk=obj.pk %}" class="btn btn-primary">
            <i class="fas fa-download me-2"></i>Download PDF
          </a>
          <a href="{% url 'update-invoice-status' pk=obj.pk %}" class="btn btn-outline-warning">
            <i class="fas fa-edit me-2"></i>Edit Status
          </a>
          <a href="{% url 'delete-invoice' pk=obj.pk %}" class="btn btn-outline-danger" onclick="return confirm('Are you sure?')">
            <i class="fas fa-trash me-2"></i>Delete
          </a>
          <a href="{% url 'home' %}" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-2"></i>Back
          </a>
        </div>
      </div>
    </div>

    <!-- Customer and Company Info -->
    <div class="row mb-4">
      <div class="col-md-6">
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <h6 class="card-title fw-bold text-muted mb-3">
              <i class="fas fa-building me-2"></i>From
            </h6>
            <p class="mb-1 fw-bold">Invoice System</p>
            <p class="text-muted small mb-0">
              45 NorthWest<br>
              Douala, Cameroon<br>
              +237 000 000 000
            </p>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <h6 class="card-title fw-bold text-muted mb-3">
              <i class="fas fa-user me-2"></i>Bill To
            </h6>
            <p class="mb-1 fw-bold">{{ obj.customer.name }}</p>
            <p class="text-muted small mb-0">
              {{ obj.customer.email }}<br>
              {{ obj.customer.phone }}<br>
              {{ obj.customer.address }}<br>
              {{ obj.customer.city }}, {{ obj.customer.zip_code }}
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Invoice Details -->
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Item</th>
                <th class="fw-bold text-center" style="width: 100px;">Qty</th>
                <th class="fw-bold text-end" style="width: 120px;">Unit Price</th>
                <th class="fw-bold text-end" style="width: 120px;">Amount</th>
              </tr>
            </thead>
            <tbody>
              {% for article in articles %}
              <tr>
                <td>
                  <p class="mb-0 fw-500">{{ article.name }}</p>
                  <small class="text-muted">ID: {{ article.id }}</small>
                </td>
                <td class="text-center">{{ article.quantity }}</td>
                <td class="text-end">{{ article.unit_price }} FCFA</td>
                <td class="text-end fw-bold">{{ article.get_total }} FCFA</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Totals Section -->
    <div class="row mb-4">
      <div class="col-md-6 ms-auto">
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <div class="d-flex justify-content-between mb-2">
              <span>Subtotal:</span>
              <span class="fw-bold">{{ obj.get_total }} FCFA</span>
            </div>
            <div class="d-flex justify-content-between mb-2">
              <span>Tax (0%):</span>
              <span class="fw-bold">0.00 FCFA</span>
            </div>
            <div class="d-flex justify-content-between mb-2">
              <span>Shipping:</span>
              <span class="fw-bold">0.00 FCFA</span>
            </div>
            <hr>
            <div class="d-flex justify-content-between">
              <span class="fw-bold">Total:</span>
              <span class="fw-bold text-primary" style="font-size: 1.25rem;">{{ obj.get_total }} FCFA</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Comments Section -->
    {% if obj.comments %}
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-body">
        <h6 class="card-title fw-bold mb-2">
          <i class="fas fa-comment me-2 text-primary"></i>Notes
        </h6>
        <p class="mb-0 text-muted">{{ obj.comments }}</p>
      </div>
    </div>
    {% endif %}

    <!-- Footer -->
    <div class="card border-0 bg-light">
      <div class="card-body text-center">
        <p class="mb-0 text-muted">
          <i class="fas fa-info-circle me-2"></i>
          Thank you for your business!
        </p>
      </div>
    </div>
  </div>
</div>

<style>
  .table-hover tbody tr:hover {
    background-color: #f8f9fa;
  }

  .card {
    transition: box-shadow 0.3s ease;
  }

  .card:hover {
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
  }
</style>

{% endblock %}
